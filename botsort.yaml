# BotSort 追踪器配置文件
# BotSort是一种高级的多目标追踪算法，支持ReID（重识别）功能，适用于复杂场景的视频追踪
# 文档参考: https://docs.ultralytics.com/modes/track/

# ============================================================================
# 基础配置
# ============================================================================

# 追踪器类型
# 说明: 指定使用的追踪算法
# 可选值: "bytetrack", "botsort"
# 默认值: "botsort"
tracker_type: botsort

# ============================================================================
# 置信度阈值配置
# ============================================================================

# 高置信度阈值（第一次关联）
# 说明: 用于第一次数据关联的检测置信度阈值，只有置信度高于此值的检测框才会参与追踪
# 取值范围: 0.0 - 1.0
# 默认值: 0.5
# 推荐设置:
#   - 熔池检测等高精度场景: 0.6-0.7
#   - 一般场景: 0.5
#   - 低置信度场景: 0.3-0.4
track_high_thresh: 0.5

# 低置信度阈值（第二次关联）
# 说明: 用于第二次数据关联的检测置信度阈值，介于low和high之间的检测框会进行第二次匹配
# 取值范围: 0.0 - 1.0，必须 < track_high_thresh
# 默认值: 0.1
# 推荐设置:
#   - 通常设置为 track_high_thresh 的 1/3 到 1/5
#   - 粘连物等小目标: 0.1-0.2
track_low_thresh: 0.1

# 新轨迹初始化阈值
# 说明: 初始化新追踪轨迹所需的最低检测置信度
# 取值范围: 0.0 - 1.0
# 默认值: 0.6
# 推荐设置:
#   - 略高于 track_high_thresh，避免误检产生新轨迹
#   - 熔池场景: 0.6-0.7
new_track_thresh: 0.6

# ============================================================================
# 轨迹管理配置
# ============================================================================

# 轨迹缓冲帧数
# 说明: 当目标丢失后，轨迹保留的最大帧数，在此期间如果重新检测到目标会恢复轨迹
# 取值范围: 整数 ≥ 0
# 默认值: 30
# 推荐设置:
#   - 高帧率视频(60fps): 60-90 (保留1-1.5秒)
#   - 标准帧率(30fps): 30-60 (保留1-2秒)
#   - 低帧率视频(15fps): 15-30 (保留1-2秒)
#   - 熔池场景(粘连物可能被电弧遮挡): 60-90
track_buffer: 90

# 轨迹匹配阈值
# 说明: IoU匹配阈值，用于判断检测框与现有轨迹是否匹配
# 取值范围: 0.0 - 1.0
# 默认值: 0.8
# 推荐设置:
#   - 快速运动目标: 0.6-0.7
#   - 一般场景: 0.8
#   - 慢速运动或精确追踪: 0.9
match_thresh: 0.8

# ============================================================================
# BotSort 特有配置
# ============================================================================

# 融合检测置信度分数
# 说明: 是否将检测框的置信度分数与IoU距离融合，用于更准确的匹配
# 取值: true 或 false
# 默认值: true
# 推荐: 对于BotSort通常保持为true
fuse_score: true

# 全局运动补偿方法
# 说明: 用于补偿摄像机运动的方法
# 可选值:
#   - "sparseOptFlow": 稀疏光流法（推荐，速度快）
#   - "orb": ORB特征匹配（速度中等）
#   - "sift": SIFT特征匹配（精度高但速度慢）
#   - "ecc": ECC图像对齐（精度高但速度慢）
#   - "None": 不使用运动补偿（摄像头固定场景）
# 默认值: "sparseOptFlow"
# 推荐设置:
#   - 固定摄像头（熔池监控）: "None"
#   - 轻微抖动: "sparseOptFlow"
#   - 移动摄像头: "orb" 或 "ecc"
gmc_method: None

# ============================================================================
# ReID（重识别）配置
# ============================================================================

# 启用重识别
# 说明: 是否启用ReID功能，用于在目标被遮挡后重新识别
# 说明: ReID可以通过外观特征匹配来恢复被遮挡的目标轨迹
# 取值: true 或 false
# 默认值: false
# 推荐设置:
#   - 复杂场景（频繁遮挡）: true
#   - 简单场景: false（节省计算资源）
#   - 熔池场景（电弧遮挡粘连物）: true
with_reid: true

# ReID模型
# 说明: 用于重识别的模型
# 可选值:
#   - "auto": 自动选择（如果检测器是YOLO则使用原生特征，否则使用yolo11n-cls.pt）
#   - "yolo11n-cls.pt": YOLO11 nano分类模型
#   - "yolo11s-cls.pt": YOLO11 small分类模型（更准确但更慢）
#   - 自定义模型路径（如TensorRT导出的模型）
# 默认值: "auto"
# 推荐设置:
#   - 一般场景: "auto"（速度快）
#   - 需要高精度ReID: "yolo11s-cls.pt"或更大模型
#   - 生产环境: 使用TensorRT导出的模型以提高速度
model: auto

# 空间邻近度阈值
# 说明: ReID匹配时的最小IoU阈值，确保空间位置接近
# 取值范围: 0.0 - 1.0
# 默认值: 0.5
# 推荐: 0.3-0.5（允许一定的位置偏移）
proximity_thresh: 0.5

# 外观相似度阈值
# 说明: ReID匹配时的最小外观相似度阈值
# 取值范围: 0.0 - 1.0
# 默认值: 0.25
# 推荐: 0.2-0.4（根据场景调整）
appearance_thresh: 0.1
# ============================================================================
# 熔池场景推荐配置
# ============================================================================
# 针对VAR熔池视频分析的推荐配置:
#
# tracker_type: botsort         # 使用BotSort追踪器
# track_high_thresh: 0.6        # 熔池、粘连物等主要目标检测较准确
# track_low_thresh: 0.15        # 允许低置信度的粘连物、锭冠检测参与第二次关联
# new_track_thresh: 0.65        # 严格的新轨迹初始化，减少误检
# track_buffer: 100             # 粘连物可能被电弧遮挡，保留更长时间
# match_thresh: 0.5             # 熔池内目标运动较快，降低匹配阈值
# fuse_score: true              # 融合置信度提高匹配准确性
# gmc_method: None              # 固定摄像头无需运动补偿
# with_reid: false              # 暂时关闭ReID以节省资源，如需要可开启
# model: auto                   # 使用自动选择的ReID模型
# proximity_thresh: 0.5         # 标准空间邻近度阈值
# appearance_thresh: 0.25       # 标准外观相似度阈值
# ============================================================================

